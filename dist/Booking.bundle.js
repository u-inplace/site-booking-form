!function(){"use strict";var e,t={726:function(e,t,s){var n=s(815),r=s.n(n),a=s(493);const i={Cleaning:"cleaning",Ironing:"ironing",Cooking:"cooking",Grocery:"grocery"};var o=s(974),c=s.n(o);class l{static queryOptions(e,t=!1){return Array.from(document.querySelectorAll(`input[id*='${e}']${t?":checked":""}`))}static getOption(e,t=!1){return document.querySelector(`input[id*='${e}']${t?":checked":""}`)}static queryRadio(e,t=!1){return Array.from(document.querySelectorAll(`input[name*='${e}']${t?":checked":""}`))}static getRadio(e,t=!1){return document.querySelector(`input[name*="${e}"]${t?":checked":""}`)}static setNextButtonDisabled(e){const t=document.querySelectorAll(".next-button-slide");Array.from(t).forEach((t=>{t.disabled=e,e?t.classList.add("disabled"):t.classList.remove("disabled")}))}static queryServices(e=!1){return l.queryOptions("service-",e)}static getSelectedServices(){return l.queryServices(!0).map((e=>e.id.replace(/^.*-/,"")))}static isServiceSelected(e){return c().includes(l.getSelectedServices(),e)}static getSelectedIroning(){return l.getRadio("ironing-size",!0)?.value?.replace(/^ironing-size-/,"")}static queryCleaningExtras(e=!1){return l.queryOptions("extra-",e)}static getSelectedCleaningExtras(){return l.queryCleaningExtras(!0).map((e=>e.id.replace(/^.*-/,"")))}static isExtraSelected(e){return c().includes(l.getSelectedCleaningExtras(),e)}static isBedroomSelected(){return l.getRadio("home-bedrooms",!0)}static isBathroomSelected(){return l.getRadio("home-bathrooms",!0)}static hide(e){document.getElementById(e).style.display="none"}static display(e){document.getElementById(e).style.display="inline-block",document.getElementById(e).style.visibility="visible",document.getElementById(e).style.transform="none"}static get postalCode(){return document.getElementById("postal-code")}static postalCodeToast(){l.toast("alert-area")}static slider=class{static get element(){return document.getElementById("booking-slider")}static get nextButtonAll(){return document.getElementById("booking-slider").querySelectorAll(".next-button-slide")}static get backButtonAll(){return document.getElementById("booking-slider").querySelectorAll(".back-button-slide")}static setActive(e){document.getElementById(`step-${e}`).classList.add("very-active")}static setInactive(e){document.getElementById(`step-${e}`).classList.remove("very-active")}static getStepHeight(e){return document.getElementById(`step-${e}`).offsetHeight}static set formHeight(e){e&&(document.getElementsByClassName("form-mask")[0].style.height=`${e+150}px`)}};static get duration(){return document.getElementById("duration").value}static get occurrence(){return l.getRadio("frequency",!0).value}static teamMember=class{static get name(){return document.getElementById("team-member-name").value}static set name(e){document.getElementById("team-member-name").value=e}static get firstName(){return document.getElementById("team-member-first-name").value}static set firstName(e){document.getElementById("team-member-first-name").value=e}static get avatar(){return document.getElementById("team-members-block").querySelector("img").src}};static summary=class{static activeService(e){document.getElementById(`summary-${e}`).classList.add("service-active")}static inactiveService(e){document.getElementById(`summary-${e}`).classList.remove("service-active")}static set duration(e){document.getElementById("summary-duration").innerText=e}static set occurrence(e){document.getElementById("summary-occurrence").innerText=e}static set payment(e){document.getElementById("summary-payment").innerText=e}};static calendar=class{static openings=class{static cleanUp(){document.getElementById("start-time-block")?.querySelectorAll(".start-time")?.forEach((e=>e.parentNode.removeChild(e)))}static showWarning(){document.getElementById("aval-warning").classList.add("msg-active")}static hideWarning(){document.getElementById("aval-warning").classList.remove("msg-active")}};static team=class{static showBlock(){document.getElementById("team-members-block").classList.add("visible")}static hideBlock(){document.getElementById("team-members-block").classList.remove("visible")}static cleanUp(){document.getElementById("team-members-block")?.querySelectorAll(".team-member")?.forEach((e=>e.parentNode.removeChild(e)))}static get memberTemplate(){return document.getElementById("team-member-template")}}};static toast(e){const t=document.getElementById(e);return t.classList.add("active"),setTimeout((()=>{t.classList.remove("active")}),4e3)}static form=class{static submitButtonText;static msgTimeout;static done(){document.getElementById("wf-form-Booking").classList.add("completed"),document.getElementById("form-done").classList.add("active")}static onSubmit(){const e=document.getElementById("button-submit");this.submitButtonText=e.value,e.value=e.attributes["data-wait"].value,e.disabled=!0,e.classList.add("wait"),this.msgTimeout&&(clearTimeout(this.msgTimeout),l.form.error.hide())}static onSubmitDone(){const e=document.getElementById("button-submit");e.value=this.submitButtonText,e.disabled=!1,e.classList.remove("wait")}static error=class{static set title(e){document.getElementById("error-title").innerText=e}static set detail(e){document.getElementById("error-detail").innerText=e}static toast(e){this.msgTimeout=l.toast(e)}};static summary=class{static activeService(e){document.getElementById(`conf-${e}`).classList.add("service-active")}static inactiveService(e){document.getElementById(`conf-${e}`).classList.remove("service-active")}static set duration(e){document.getElementById("conf-duration").innerText=e}static set occurrence(e){document.getElementById("conf-occurrence").innerText=e}static set payment(e){document.getElementById("conf-payment").innerText=e}static set start(e){document.getElementById("conf-start").innerText=e}static set team(e){document.getElementById("conf-team-avatar").src=e.avatar,document.getElementById("conf-team-name").innerText=e.firstName}}}}class u{static async logError(e,t){console.log("Something went wrong..."),console.log(`Status: ${e.status} ${e.statusText}`),t?console.log(`Response: ${JSON.stringify(t)}`):console.log(`Response: ${e}`)}static createSummary(){const e=l.getSelectedServices();Object.values(i).forEach((t=>e.includes(t)?l.form.summary.activeService(t):l.form.summary.inactiveService(t)));const{duration:t}=l;l.form.summary.duration=`${t}h`,l.form.summary.payment=`${t} titres-services`;const s=document.getElementById("start-timestamp").value;l.form.summary.start=(0,a.Z)(new Date(s),"dd/MM/yyyy H:mm");const{occurrence:n}=l;l.form.summary.occurrence=n,l.form.summary.team=l.teamMember}static async onSubmit(e){e.preventDefault();const t=e.target,s=new FormData(t),n=Object.fromEntries(s.entries()),r=new URL(t.attributes.action.value);try{l.form.onSubmit();const e=await fetch(r,{method:"POST",headers:{contentType:"application/json",dataType:"json"},body:JSON.stringify(n)}),t=await e.json();e.status>=300?(u.logError(e,t),t?.errors?.sodexo_reference?l.form.error.toast("toast-sodexo"):"UNAVAILABLE_TIME_SLOT"===t?.error?l.form.error.toast("toast-unavailable-slot"):t?.errors?.[0].includes("sodexo number is already linked ")?l.form.error.toast("toast-sodexo-duplicated"):l.form.error.toast("toast-submit-error"),l.form.onSubmitDone()):setTimeout((()=>{u.createSummary(),l.form.done()}),1e3)}catch(e){u.logError(e.message),l.form.error.toast("toast-submit-error"),l.form.onSubmitDone()}}}class d{steps;constructor(e){this.steps=e}static getInstance(){return this.instance??=new d,this.instance}get estimation(){return Math.floor(Object.values(this.steps).reduce(((e,t)=>e+(t?t.duration:0)),3))}static set estimation(e){document.getElementById("duration").nextElementSibling.noUiSlider.set(e)}updateEstimation(){d.estimation=this.estimation}static get coverage(){return["1070","1160","1082","1000","1040","1140","1190","1083","1130","1050","1090","1081","1020","1080","1120","1060","1210","1030","1180","1170","1200","1150"]}}class m{#e;constructor(){this.reset()}reset(e=!1){!e&&(this.#e=0);let t=[0,1];l.isServiceSelected(i.Ironing)&&t.push(2),l.isServiceSelected(i.Cleaning)&&t.push(3),t=t.concat([4,5,6]),this.list=t}get next(){return this.#e++,console.log(`Seq : ${this.list} ; curr : ${this.#e}`),this.list[this.#e]}get prev(){return this.#e--,console.log(`Seq : ${this.list} ; curr : ${this.#e}`),this.list[this.#e]}get total(){return this.list.length}get current(){return this.list[this.#e]}get currentIndex(){return this.#e}}class g{#t;#s;constructor(e){this.#t=e||new m}static getInstance(){return this.instance??=new g,this.instance}set onChange(e){this.#s=e}resize(){l.slider.formHeight=l.slider.getStepHeight(this.current)}set sequence(e){this.#t=e}get sequence(){return this.#t}get current(){return this.#t.current}next(){const{current:e}=this.#t;l.slider.setInactive(e);const{next:t}=this.#t;l.slider.setActive(t),this.resize(),this.#s("next")}prev(){const{current:e}=this.#t;l.slider.setInactive(e);const{prev:t}=this.#t;l.slider.setActive(t),this.resize(),this.#s("back")}}var h=s(28),p=s.n(h),y=s(886),v=s(102);const b=e=>new Date(e).toISOString().slice(0,10),f="loaderBalls";class x{#n;#r;#a;#i;#o;constructor(e,t,s){this.#i={},this.#a=t,this.#o=s,this.#r=!1,this.#n=e,this.calendar=new(p())({id:`#${e}`,theme:"glass",weekdayType:"long-upper",startWeekday:1,monthDisplayType:"long",primaryColor:"#2aae75",fontFamilyHeader:"Poppins, sans-serif",fontFamilyWeekdays:"Poppins, sans-serif",fontFamilyBody:"Poppins, sans-serif",calendarSize:"large",layoutModifiers:["month-left-align"],dropShadow:"",dateChanged:this.onDateChange,monthChanged:this.onMonthChange}),this.addLoadingAnimation()}async init(){if(this.#r=!0,0===this.calendar.getEventsData().length){const e=new Date,t=(0,y.Z)(e,1);await this.getMonthAvailability(t)}const e=c().sortBy(this.calendar.getEventsData(),"start");e?.length>0&&this.calendar.setDate(e[0]?.start)}onMonthChange=async e=>{const t=(0,v.Z)(e);await this.getMonthAvailability(t),this.#r||this.init()};onDateChange=(e,t)=>{this.#o(e,t)};toggleLoading(e){const t=document.getElementById(f);t&&(t.style.visibility=e?"visible":"hidden")}addLoadingAnimation(){const e=document.createElement("div");e.classList.add("loader"),e.id=f,e.style.visibility="visible",e.innerHTML='\n            <span class="loader__element"></span>\n        ',document.getElementsByClassName("calendar__monthyear")[0].appendChild(e)}async getMonthAvailability(e){this.toggleLoading(!0),await Promise.all((e=>{const t=e?new Date(e.getTime()):new Date,s=t.getMonth(),n=[];for(t.setDate(1);t.getMonth()===s;)n.push(new Date(t.getTime())),t.setDate(t.getDate()+7);return n})(e).map((e=>this.getAvailability(e)))),this.toggleLoading()}async getAvailability(e){const t=b(e);if(e<new Date||this.#i[t])return;this.#i[t]=!0;const s=new URL("https://inplace-booking.azurewebsites.net/api/availability"),n=new URLSearchParams({code:"jDlOk9eyca7HVUuVn2fRaIDQmv57z9l8bCHssUSMzpDugndIrzi5Tw==",postalCode:this.#a.postalCode,duration:this.#a.duration,recurrence:this.#a.recurrence,weekSearchDate:b(e)});s.search=n;const r=await fetch(s),a=await r.json(),i=c().compact(a?.data?.map((t=>t.time_slots.map((t=>(t=>{if(new Date(t.start_time).getMonth()===e.getMonth())return{start:new Date(t.start_time),end:new Date(t.end_time),start_time:t.label,employee:{id:t.affiliate_worker.worker_contract_id,first_name:t.affiliate_worker.first_name,last_name:t.affiliate_worker.last_name,allergies:t.affiliate_worker.allergies}}})(t))))).flat());i.length>0&&this.calendar.addEventsData(i)}}class S{list;constructor(e=[],t="change"){this.list=e.map((e=>({elem:e,event:t})))}push(e){this.list=this.list.concat(e)}}class w extends class{slider;model;constructor(){this.slider=g.getInstance(),this.model=d.getInstance()}get observed(){return[]}get isNextDisabled(){return!1}get duration(){return 0}get autoFollow(){return!1}wireEvents(e){e.forEach((e=>e?.elem?.addEventListener(e.event,e.handler)))}init(){this.wireEvents(this.observed)}}{stepNo;constructor(e){super(),this.stepNo=e}get observed(){return[{elem:l.slider.nextButtonAll[this.stepNo],event:"click",handler:this.onNext.bind(this)},{elem:l.slider.backButtonAll[this.stepNo-1],event:"click",handler:this.onBack.bind(this)},...this.toggleNextWatcher.list.map((e=>({...e,handler:this.toggleNext.bind(this)})))]}get toggleNextWatcher(){return new S}set toggleNextWatcher(e){this.wireEvents(e.list.map((e=>({...e,handler:this.toggleNext.bind(this)}))))}init(){super.init(),l.setNextButtonDisabled(!0),this.toggleNextWatcher.list.forEach((e=>e.elem.checked=!1))}toggleNext(e=!1){const t=this.isNextDisabled;l.setNextButtonDisabled(this.isNextDisabled),t||"boolean"==typeof e&&e||!this.autoFollow||(document.activeElement.blur(),document.getElementById(`step-${this.stepNo}`).querySelector(".next-button-slide").classList.add("wait"),setTimeout((()=>{document.getElementById(`step-${this.stepNo}`).querySelector(".next-button-slide").classList.remove("wait"),this.onNext()}),500))}onNext(){this.slider.next(),document.querySelectorAll("input").forEach((e=>e.setAttribute("tabindex",0)))}onBack(){this.slider.prev()}get sequence(){return this.slider.sequence}onActive(e){this.updateNav(),this.toggleNext("back"===e)}updateNav(){document.getElementsByClassName("step-number")[this.stepNo-1].innerHTML=`Step ${this.sequence.currentIndex}/${this.sequence.total-1}`}}class E extends w{#c;constructor(e,...t){super(e),this.#c=t}get isNextDisabled(){return this.#c.reduce(((e,t)=>e||t.isNextDisabled),!1)}get toggleNextWatcher(){const e=new S;return this.#c.forEach((t=>e.push(t.toggleNextWatcher.list))),e}get duration(){return this.#c.reduce(((e,t)=>e+t.duration),0)}onNext(){super.onNext()}onBack(){super.onBack()}}class B{get isNextDisabled(){return!1}get toggleNextWatcher(){return new S}get duration(){return 0}}class I extends B{get isNextDisabled(){return!l.getOption("supplies-conf",!0)}get toggleNextWatcher(){return new S(l.queryOptions("supplies-conf"))}}class N extends w{get toggleNextWatcher(){return new S(l.queryCleaningExtras())}get duration(){if(!l.isServiceSelected(i.Cleaning))return 0;let e=l.isExtraSelected("windows")?1:0;return e+=l.isExtraSelected("cabinets")?1:0,e+=l.isExtraSelected("fridge")?.5:0,e+=l.isExtraSelected("oven")?.5:0,e}}class k extends B{get isNextDisabled(){return!l.isBedroomSelected()||!l.isBathroomSelected()}get toggleNextWatcher(){return new S(l.queryRadio("home-"))}get duration(){if(!l.isServiceSelected(i.Cleaning))return 0;const e=l.getRadio("home-bedrooms",!0)?.value,t=l.getRadio("home-bathrooms",!0)?.value;let s=0;switch(e){case"3":case"4":s+=1;break;case"5+":s+=2}switch(t){case"2":s+=1;break;case"3":s+=2;break;case"4+":s+=3}return s}}var q={0:new class extends w{constructor(){super(0)}init(){super.init(),l.postalCode.autofocus=!0,l.postalCode.focus(),l.slider.setActive(0),this.slider.resize()}get isNextDisabled(){const e=l.postalCode;return e.value.length!==e.maxLength||!d.coverage.includes(e.value)}get toggleNextWatcher(){return new S([l.postalCode],"input")}get observed(){return[...super.observed,{elem:l.postalCode,event:"input",handler:this.onPostalCodeInput}]}onNext(){l.postalCode.blur(),document.activeElement.blur(),super.onNext()}get autoFollow(){return!0}updateNav(){return null}onPostalCodeInput(e){const t=e.target;t.value.length>t.maxLength&&(t.value=t.value.slice(0,t.maxLength)),t.value.length!==t.maxLength||d.coverage.includes(t.value)||(window.scrollTo({top:0,behavior:"smooth"}),l.postalCodeToast())}},1:new class extends w{constructor(){super(1)}get isNextDisabled(){return 0===l.getSelectedServices().length}get toggleNextWatcher(){return new S(l.queryServices())}get duration(){let e=0;return l.getSelectedServices().length>1&&(e+=l.isServiceSelected(i.Cooking)?.5:0,e+=l.isServiceSelected(i.Grocery)?.5:0),e}updateNav(){document.getElementsByClassName("step-number")[this.stepNo-1].innerHTML="Step 1/-"}onNext(){this.sequence.reset(!0),super.onNext()}},2:new class extends w{constructor(){super(2)}get isNextDisabled(){return!l.getSelectedIroning()}get toggleNextWatcher(){return new S(l.queryOptions("ironing-size"),"click")}get duration(){if(!l.isServiceSelected(i.Ironing))return 0;switch(l.getSelectedIroning()){case"xs":return.5;case"s":return 1;case"m":return 2;case"l":return 3;case"xl":return 4;default:return 0}}},3:new class extends E{constructor(){super(3,new I,new N,new k)}},4:new class extends w{constructor(){super(4)}get isNextDisabled(){return!l.getRadio("frequency",!0)}get toggleNextWatcher(){return new S(l.queryRadio("frequency"),"click")}onActive(e){"next"===e&&this.model.updateEstimation(),super.onActive(e)}},5:new class extends w{#l;openings;team;constructor(){super(5)}get isNextDisabled(){return!l.getRadio("team-member",!0)}onActive(e){"back"!==e&&(super.onActive(),this.#u(),l.calendar.team.cleanUp(),this.toggleNext(),this.#l=new x("availability-cal",{postalCode:l.postalCode.value,duration:l.duration,recurrence:l.occurrence},this.onDayChange.bind(this)),this.#d())}async#u(){const e=new URL("https://inplace-booking.azurewebsites.net/api/collection"),t=new URLSearchParams({code:"Itrex4w/daAwDFd78PsawdASdJyo9clkm1OOhG0Z3GLEe6m484/49A==",name:"team"});e.search=t;const s=await fetch(e),n=await s.json();this.team=n}#d(){const e=l.getSelectedServices();Object.values(i).forEach((t=>e.includes(t)?l.summary.activeService(t):l.summary.inactiveService(t)));const{duration:t}=l;l.summary.duration=`${t}h`,l.summary.payment=`${t} titres-services`;const{occurrence:s}=l;l.summary.occurrence=s}onDayChange(e,t){const s=document.getElementById("start-time-template");this.openings=t,l.calendar.openings.cleanUp(),l.calendar.team.hideBlock(),c().isEmpty(t)?l.calendar.openings.showWarning():l.calendar.openings.hideWarning(),c().uniqBy(t,"start_time").forEach((e=>{this.copyTemplate(s,{className:"start-time",parentId:"start-time-block",labelClass:"start-time-text",labelText:e.start_time,radioGroup:"start-time",radioEvent:"click",radioEventHandler:this.onStartTimeSelect.bind(this),radioValue:e.start_time})}))}onStartTimeSelect(e){l.calendar.team.cleanUp(),l.calendar.team.showBlock();const t=e.target.value,s=l.calendar.team.memberTemplate;document.getElementById("start-timestamp").value=this.openings[0].start.toISOString(),document.getElementById("end-timestamp").value=this.openings[0].end.toISOString(),c().filter(this.openings,{start_time:t}).forEach((e=>{const t=this.copyTemplate(s,{className:"team-member",parentId:"team-members-block",labelClass:"team-member-name",labelText:e.employee.first_name,radioGroup:"team-member",radioValue:e.employee.id,radioEvent:"click",radioEventHandler:this.onTeamMemberSelect.bind(this)}),n=c().find(this.team,{name:`${e.employee.first_name} ${e.employee.last_name}`})?.["profile-picture"];n?.url&&(t.querySelector(".team-avatar").src=n.url),t.querySelector("input").setAttribute("member-name",`${e.employee.first_name} ${e.employee.last_name}`),t.querySelector("input").setAttribute("member-first-name",`${e.employee.first_name}`)})),this.toggleNextWatcher=new S(l.queryRadio("team-member"),"click"),this.toggleNext(),this.slider.resize()}onTeamMemberSelect(e){const t=e.target;l.teamMember.name=t.getAttribute("member-name"),l.teamMember.firstName=t.getAttribute("member-first-name")}copyTemplate(e,t){const s=e.cloneNode(!0);s.setAttribute("id",""),s.style.display="flex",s.classList.add(t.className);const n=s.querySelector(`input[name*='${t.radioGroup}']`);return n.setAttribute("id",""),n.value=t.radioValue,t.radioEvent&&n.addEventListener(t.radioEvent,t.radioEventHandler),s.querySelector(`.${t.labelClass}`).innerText=t.labelText,document.getElementById(t.parentId).appendChild(s),s}},6:new class extends w{constructor(){super(6)}onActive(e){super.onActive(e),this.setDefaultLang()}setDefaultLang(){const e=document.querySelector(".wg-element-wrapper.sw8")?.querySelector(".w-dropdown-toggle")?.getAttribute("lang");document.getElementById(e).click()}}};class C{#m;#t;#g;init(){this.#g=d.getInstance(),this.#g.steps=q,this.#m=g.getInstance(),this.#t=new m,this.#m.sequence=this.#t,this.#m.onChange=this.onChange.bind(this),Object.values(q).forEach((e=>e.init())),q[0].onActive("back")}onChange(e){q[this.#m.current].onActive(e)}}var D=D||window.Webflow||[];D.push((()=>{r().polyfill(),(new C).init(),document.getElementById("wf-form-Booking").onsubmit=u.onSubmit.bind(void 0)}))}},s={};function n(e){var r=s[e];if(void 0!==r)return r.exports;var a=s[e]={id:e,loaded:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=t,e=[],n.O=function(t,s,r,a){if(!s){var i=1/0;for(u=0;u<e.length;u++){s=e[u][0],r=e[u][1],a=e[u][2];for(var o=!0,c=0;c<s.length;c++)(!1&a||i>=a)&&Object.keys(n.O).every((function(e){return n.O[e](s[c])}))?s.splice(c--,1):(o=!1,a<i&&(i=a));if(o){e.splice(u--,1);var l=r();void 0!==l&&(t=l)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[s,r,a]},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={671:0};n.O.j=function(t){return 0===e[t]};var t=function(t,s){var r,a,i=s[0],o=s[1],c=s[2],l=0;if(i.some((function(t){return 0!==e[t]}))){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(c)var u=c(n)}for(t&&t(s);l<i.length;l++)a=i[l],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},s=self.webpackChunkui_booking=self.webpackChunkui_booking||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var r=n.O(void 0,[736],(function(){return n(726)}));r=n.O(r)}();
//# sourceMappingURL=Booking.bundle.js.map