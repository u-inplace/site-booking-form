!function(){"use strict";var e,t={436:function(e,t,s){var n=s(815),i=s.n(n),r=s(974),a=s.n(r);class o{static queryOptions(e,t=!1){return Array.from(document.querySelectorAll(`input[id*='${e}']${t?":checked":""}`))}static getOption(e,t=!1){return document.querySelector(`input[id*='${e}']${t?":checked":""}`)}static queryRadio(e,t=!1){return Array.from(document.querySelectorAll(`input[name*='${e}']${t?":checked":""}`))}static getRadio(e,t=!1){return document.querySelector(`input[name*="${e}"]${t?":checked":""}`)}static setNextButtonDisabled(e){const t=document.querySelectorAll(".next-button-slide");Array.from(t).forEach((t=>{t.disabled=e,e?t.classList.add("disabled"):t.classList.remove("disabled")}))}static queryServices(e=!1){return o.queryOptions("service-",e)}static getSelectedServices(){return o.queryServices(!0).map((e=>e.id.replace(/^.*-/,"")))}static isServiceSelected(e){return a().includes(o.getSelectedServices(),e)}static getSelectedIroning(){return o.getRadio("ironing-size",!0)?.value?.replace(/^ironing-size-/,"")}static queryCleaningExtras(e=!1){return o.queryOptions("extra-",e)}static getSelectedCleaningExtras(){return o.queryCleaningExtras(!0).map((e=>e.id.replace(/^.*-/,"")))}static isExtraSelected(e){return a().includes(o.getSelectedCleaningExtras(),e)}static isBedroomSelected(){return o.getRadio("home-bedrooms",!0)}static isBathroomSelected(){return o.getRadio("home-bathrooms",!0)}static hide(e){document.getElementById(e).style.display="none"}static display(e){document.getElementById(e).style.display="inline-block",document.getElementById(e).style.visibility="visible",document.getElementById(e).style.transform="none"}static get postalCode(){return document.getElementById("postal-code")}static postalCodeToast(){o.toast("alert-area")}static slider=class{static get element(){return document.getElementById("booking-slider")}static get nextButtonAll(){return document.getElementById("booking-slider").querySelectorAll(".next-button-slide")}static get backButtonAll(){return document.getElementById("booking-slider").querySelectorAll(".back-button-slide")}static setActive(e){document.getElementById(`step-${e}`).classList.add("very-active")}static setInactive(e){document.getElementById(`step-${e}`).classList.remove("very-active")}static getStepHeight(e){return document.getElementById(`step-${e}`).offsetHeight}static set formHeight(e){e&&(document.getElementsByClassName("form-mask")[0].style.height=`${e+150}px`)}};static get duration(){return document.getElementById("duration").value}static get occurrence(){return o.getRadio("frequency",!0).value}static summary=class{static activeService(e){document.getElementById(`summary-${e}`).classList.add("service-active")}static inactiveService(e){document.getElementById(`summary-${e}`).classList.remove("service-active")}static set duration(e){document.getElementById("summary-duration").innerText=e}static set occurrence(e){document.getElementById("summary-occurrence").innerText=e}static set payment(e){document.getElementById("summary-payment").innerText=e}};static calendar=class{static openings=class{static cleanUp(){document.getElementById("start-time-block")?.querySelectorAll(".start-time")?.forEach((e=>e.parentNode.removeChild(e)))}static showWarning(){document.getElementById("aval-warning").classList.add("msg-active")}static hideWarning(){document.getElementById("aval-warning").classList.remove("msg-active")}};static team=class{static showBlock(){document.getElementById("team-members-block").classList.add("visible")}static hideBlock(){document.getElementById("team-members-block").classList.remove("visible")}static cleanUp(){document.getElementById("team-members-block")?.querySelectorAll(".team-member")?.forEach((e=>e.parentNode.removeChild(e)))}static get memberTemplate(){return document.getElementById("team-member-template")}}};static toast(e){const t=document.getElementById(e);return t.classList.add("active"),setTimeout((()=>{t.classList.remove("active")}),4e3)}static form=class{static submitButtonText;static msgTimeout;static done(){document.getElementById("wf-form-Booking").classList.add("completed"),document.getElementById("form-done").classList.add("active")}static onSubmit(){const e=document.getElementById("button-submit");this.submitButtonText=e.value,e.value=e.attributes["data-wait"].value,e.disabled=!0,e.classList.add("wait"),this.msgTimeout&&(clearTimeout(this.msgTimeout),o.form.error.hide())}static onSubmitDone(){const e=document.getElementById("button-submit");e.value=this.submitButtonText,e.disabled=!1,e.classList.remove("wait")}static error=class{static set title(e){document.getElementById("error-title").innerText=e}static set detail(e){document.getElementById("error-detail").innerText=e}static toast(e){this.msgTimeout=o.toast(e)}}}}class c{steps;constructor(e){this.steps=e}static getInstance(){return this.instance??=new c,this.instance}get estimation(){return Math.floor(Object.values(this.steps).reduce(((e,t)=>e+(t?t.duration:0)),3))}static set estimation(e){document.getElementById("duration").nextElementSibling.noUiSlider.set(e)}updateEstimation(){c.estimation=this.estimation}static get coverage(){return["1070","1160","1082","1000","1040","1140","1190","1083","1130","1050","1090","1081","1020","1080","1120","1060","1210","1030","1180","1170","1200","1150"]}}const l={Cleaning:"cleaning",Ironing:"ironing",Cooking:"cooking",Grocery:"grocery"};class d{#e;constructor(){this.reset()}reset(e=!1){!e&&(this.#e=0);let t=[0,1];o.isServiceSelected(l.Ironing)&&t.push(2),o.isServiceSelected(l.Cleaning)&&t.push(3),t=t.concat([4,5,6]),this.list=t}get next(){return this.#e++,console.log(`Seq : ${this.list} ; curr : ${this.#e}`),this.list[this.#e]}get prev(){return this.#e--,console.log(`Seq : ${this.list} ; curr : ${this.#e}`),this.list[this.#e]}get total(){return this.list.length}get current(){return this.list[this.#e]}get currentIndex(){return this.#e}}class u{#t;#s;constructor(e){this.#t=e||new d,window.addEventListener("load",(()=>this.resize()),!1),window.addEventListener("resize",(()=>this.resize()),!1)}static getInstance(){return this.instance??=new u,this.instance}set onChange(e){this.#s=e}resize(){o.slider.formHeight=o.slider.getStepHeight(this.current)}set sequence(e){this.#t=e}get sequence(){return this.#t}get current(){return this.#t.current}next(){const{current:e}=this.#t;o.slider.setInactive(e);const{next:t}=this.#t;o.slider.setActive(t),this.resize(),this.#s("next")}prev(){const{current:e}=this.#t;o.slider.setInactive(e);const{prev:t}=this.#t;o.slider.setActive(t),this.resize(),this.#s("back")}}var m=s(28),g=s.n(m),h=s(263),p=s(102);const y=e=>new Date(e).toISOString().slice(0,10),v="loaderBalls";class b{#n;#i;#r;#a;#o;constructor(e,t,s){this.#a={},this.#r=t,this.#o=s,this.#i=!1,this.#n=e,this.calendar=new(g())({id:`#${e}`,theme:"glass",weekdayType:"long-upper",startWeekday:1,monthDisplayType:"long",primaryColor:"#2aae75",fontFamilyHeader:"Poppins, sans-serif",fontFamilyWeekdays:"Poppins, sans-serif",fontFamilyBody:"Poppins, sans-serif",calendarSize:"large",layoutModifiers:["month-left-align"],dropShadow:"",dateChanged:this.onDateChange,monthChanged:this.onMonthChange}),this.addLoadingAnimation()}async init(){if(this.#i=!0,0===this.calendar.getEventsData().length){const e=new Date,t=(0,h.Z)(e,1);await this.getMonthAvailability(t)}const e=a().sortBy(this.calendar.getEventsData(),"start");e?.length>0&&this.calendar.setDate(e[0]?.start)}onMonthChange=async e=>{const t=(0,p.Z)(e);await this.getMonthAvailability(t),this.#i||this.init()};onDateChange=(e,t)=>{this.#o(e,t)};toggleLoading(e){const t=document.getElementById(v);t&&(t.style.visibility=e?"visible":"hidden")}addLoadingAnimation(){const e=document.createElement("div");e.classList.add("loader"),e.id=v,e.style.visibility="visible",e.innerHTML='\n            <span class="loader__element"></span>\n        ',document.getElementsByClassName("calendar__monthyear")[0].appendChild(e)}async getMonthAvailability(e){this.toggleLoading(!0),await Promise.all((e=>{const t=e?new Date(e.getTime()):new Date,s=t.getMonth(),n=[];for(t.setDate(1);t.getMonth()===s;)n.push(new Date(t.getTime())),t.setDate(t.getDate()+7);return n})(e).map((e=>this.getAvailability(e)))),this.toggleLoading()}async getAvailability(e){const t=y(e);if(e<new Date||this.#a[t])return;this.#a[t]=!0;const s=new URL("https://inplace-booking.azurewebsites.net/api/availability"),n=new URLSearchParams({code:"jDlOk9eyca7HVUuVn2fRaIDQmv57z9l8bCHssUSMzpDugndIrzi5Tw==",postalCode:this.#r.postalCode,duration:this.#r.duration,recurrence:this.#r.recurrence,weekSearchDate:y(e)});s.search=n;const i=await fetch(s),r=await i.json(),o=a().compact(r?.data?.map((t=>t.time_slots.map((t=>(t=>{if(new Date(t.start_time).getMonth()===e.getMonth())return{start:new Date(t.start_time),end:new Date(t.end_time),start_time:t.label,employee:{id:t.affiliate_worker.worker_contract_id,first_name:t.affiliate_worker.first_name,last_name:t.affiliate_worker.last_name,allergies:t.affiliate_worker.allergies}}})(t))))).flat());o.length>0&&this.calendar.addEventsData(o)}}class f{list;constructor(e=[],t="change"){this.list=e.map((e=>({elem:e,event:t})))}push(e){this.list=this.list.concat(e)}}class w extends class{slider;model;constructor(){this.slider=u.getInstance(),this.model=c.getInstance()}get observed(){return[]}get isNextDisabled(){return!1}get duration(){return 0}get autoFollow(){return!1}wireEvents(e){e.forEach((e=>e?.elem?.addEventListener(e.event,e.handler)))}init(){this.wireEvents(this.observed)}}{stepNo;constructor(e){super(),this.stepNo=e}get observed(){return[{elem:o.slider.nextButtonAll[this.stepNo],event:"click",handler:this.onNext.bind(this)},{elem:o.slider.backButtonAll[this.stepNo-1],event:"click",handler:this.onBack.bind(this)},...this.toggleNextWatcher.list.map((e=>({...e,handler:this.toggleNext.bind(this)})))]}get toggleNextWatcher(){return new f}set toggleNextWatcher(e){this.wireEvents(e.list.map((e=>({...e,handler:this.toggleNext.bind(this)}))))}init(){super.init(),o.setNextButtonDisabled(!0),this.toggleNextWatcher.list.forEach((e=>e.elem.checked=!1))}toggleNext(e=!1){const t=this.isNextDisabled;o.setNextButtonDisabled(this.isNextDisabled),t||"boolean"==typeof e&&e||!this.autoFollow||(document.activeElement.blur(),document.getElementById(`step-${this.stepNo}`).querySelector(".next-button-slide").classList.add("wait"),setTimeout((()=>{document.getElementById(`step-${this.stepNo}`).querySelector(".next-button-slide").classList.remove("wait"),this.onNext()}),500))}onNext(){this.slider.next()}onBack(){this.slider.prev()}get sequence(){return this.slider.sequence}onActive(e){this.updateNav(),this.toggleNext("back"===e)}updateNav(){document.getElementsByClassName("step-number")[this.stepNo-1].innerHTML=`Step ${this.sequence.currentIndex}/${this.sequence.total-1}`}}class x extends w{#c;constructor(e,...t){super(e),this.#c=t}get isNextDisabled(){return this.#c.reduce(((e,t)=>e||t.isNextDisabled),!1)}get toggleNextWatcher(){const e=new f;return this.#c.forEach((t=>e.push(t.toggleNextWatcher.list))),e}get duration(){return this.#c.reduce(((e,t)=>e+t.duration),0)}onNext(){super.onNext()}onBack(){super.onBack()}}class S{get isNextDisabled(){return!1}get toggleNextWatcher(){return new f}get duration(){return 0}}class E extends S{get isNextDisabled(){return!o.getOption("supplies-conf",!0)}get toggleNextWatcher(){return new f(o.queryOptions("supplies-conf"))}}class B extends w{get toggleNextWatcher(){return new f(o.queryCleaningExtras())}get duration(){if(!o.isServiceSelected(l.Cleaning))return 0;let e=o.isExtraSelected("windows")?1:0;return e+=o.isExtraSelected("cabinets")?1:0,e+=o.isExtraSelected("fridge")?.5:0,e+=o.isExtraSelected("oven")?.5:0,e}}class I extends S{get isNextDisabled(){return!o.isBedroomSelected()||!o.isBathroomSelected()}get toggleNextWatcher(){return new f(o.queryRadio("home-"))}get duration(){if(!o.isServiceSelected(l.Cleaning))return 0;const e=o.getRadio("home-bedrooms",!0)?.value,t=o.getRadio("home-bathrooms",!0)?.value;let s=0;switch(e){case"3":case"4":s+=1;break;case"5+":s+=2}switch(t){case"2":s+=1;break;case"3":s+=2;break;case"4+":s+=3}return s}}var N={0:new class extends w{constructor(){super(0)}init(){super.init(),o.postalCode.autofocus=!0,o.postalCode.focus(),o.slider.setActive(0),this.slider.resize()}get isNextDisabled(){const e=o.postalCode;return e.value.length!==e.maxLength||!c.coverage.includes(e.value)}get toggleNextWatcher(){return new f([o.postalCode],"input")}get observed(){return[...super.observed,{elem:o.postalCode,event:"input",handler:this.onPostalCodeInput}]}onNext(){o.postalCode.blur(),document.activeElement.blur(),super.onNext()}get autoFollow(){return!0}updateNav(){return null}onPostalCodeInput(e){const t=e.target;t.value.length>t.maxLength&&(t.value=t.value.slice(0,t.maxLength)),t.value.length!==t.maxLength||c.coverage.includes(t.value)||(window.scrollTo({top:0,behavior:"smooth"}),o.postalCodeToast())}},1:new class extends w{constructor(){super(1)}get isNextDisabled(){return 0===o.getSelectedServices().length}get toggleNextWatcher(){return new f(o.queryServices())}get duration(){let e=0;return o.getSelectedServices().length>1&&(e+=o.isServiceSelected(l.Cooking)?.5:0,e+=o.isServiceSelected(l.Grocery)?.5:0),e}updateNav(){document.getElementsByClassName("step-number")[this.stepNo-1].innerHTML="Step 1/-"}onNext(){this.sequence.reset(!0),super.onNext()}},2:new class extends w{constructor(){super(2)}get isNextDisabled(){return!o.getSelectedIroning()}get toggleNextWatcher(){return new f(o.queryOptions("ironing-size"),"click")}get duration(){if(!o.isServiceSelected(l.Ironing))return 0;switch(o.getSelectedIroning()){case"xs":return.5;case"s":return 1;case"m":return 2;case"l":return 3;case"xl":return 4;default:return 0}}},3:new class extends x{constructor(){super(3,new E,new B,new I)}},4:new class extends w{constructor(){super(4)}get isNextDisabled(){return!o.getRadio("frequency",!0)}get toggleNextWatcher(){return new f(o.queryRadio("frequency"),"click")}onActive(e){"next"===e&&this.model.updateEstimation(),super.onActive(e)}},5:new class extends w{#l;openings;team;constructor(){super(5)}get isNextDisabled(){return!o.getRadio("team-member",!0)}onActive(e){"back"!==e&&(super.onActive(),this.#d(),o.calendar.team.cleanUp(),this.toggleNext(),this.#l=new b("availability-cal",{postalCode:o.postalCode.value,duration:o.duration,recurrence:o.occurrence},this.onDayChange.bind(this)),this.#u())}async#d(){const e=new URL("https://inplace-booking.azurewebsites.net/api/collection"),t=new URLSearchParams({code:"Itrex4w/daAwDFd78PsawdASdJyo9clkm1OOhG0Z3GLEe6m484/49A==",name:"team"});e.search=t;const s=await fetch(e),n=await s.json();this.team=n}#u(){const e=o.getSelectedServices();Object.values(l).forEach((t=>e.includes(t)?o.summary.activeService(t):o.summary.inactiveService(t)));const{duration:t}=o;o.summary.duration=`${t}h`,o.summary.payment=`${t} titres-services`;const{occurrence:s}=o;o.summary.occurrence=s}onDayChange(e,t){const s=document.getElementById("start-time-template");this.openings=t,o.calendar.openings.cleanUp(),o.calendar.team.hideBlock(),a().isEmpty(t)?o.calendar.openings.showWarning():o.calendar.openings.hideWarning(),a().uniqBy(t,"start_time").forEach((e=>{this.copyTemplate(s,{className:"start-time",parentId:"start-time-block",labelClass:"start-time-text",labelText:e.start_time,radioGroup:"start-time",radioEvent:"click",radioEventHandler:this.onStartTimeSelect.bind(this),radioValue:e.start_time})}))}onStartTimeSelect(e){o.calendar.team.cleanUp(),o.calendar.team.showBlock();const t=e.target.value,s=o.calendar.team.memberTemplate;document.getElementById("start-timestamp").value=this.openings[0].start.toISOString(),document.getElementById("end-timestamp").value=this.openings[0].end.toISOString(),a().filter(this.openings,{start_time:t}).forEach((e=>{const t=this.copyTemplate(s,{className:"team-member",parentId:"team-members-block",labelClass:"team-member-name",labelText:e.employee.first_name,radioGroup:"team-member",radioValue:e.employee.id}),n=a().find(this.team,{name:`${e.employee.first_name} ${e.employee.last_name}`})?.["profile-picture"];n?.url&&(t.querySelector(".team-avatar").src=n.url)})),this.toggleNextWatcher=new f(o.queryRadio("team-member"),"click"),this.toggleNext(),this.slider.resize()}copyTemplate(e,t){const s=e.cloneNode(!0);s.setAttribute("id",""),s.style.display="flex",s.classList.add(t.className);const n=s.querySelector(`input[name*='${t.radioGroup}']`);return n.setAttribute("id",""),n.value=t.radioValue,t.radioEvent&&n.addEventListener(t.radioEvent,t.radioEventHandler),s.querySelector(`.${t.labelClass}`).innerText=t.labelText,document.getElementById(t.parentId).appendChild(s),s}},6:new class extends w{constructor(){super(6)}onActive(e){super.onActive(e),this.setDefaultLang()}setDefaultLang(){const e=document.querySelector(".wg-element-wrapper.sw8")?.querySelector(".w-dropdown-toggle")?.getAttribute("lang");document.getElementById(e).click()}}};class k{#m;#t;#g;init(){this.#g=c.getInstance(),this.#g.steps=N,this.#m=u.getInstance(),this.#t=new d,this.#m.sequence=this.#t,this.#m.onChange=this.onChange.bind(this),Object.values(N).forEach((e=>e.init())),N[0].onActive("back")}onChange(e){N[this.#m.current].onActive(e)}}const C=async e=>{console.log("Something went wrong..."),console.log(`Status: ${e.status} ${e.statusText}`),e?.body?console.log(`Response: ${await(e?.body)}`):console.log(`Response: ${e}`)},q=async e=>{e.preventDefault();const t=e.target,s=new FormData(t),n=Object.fromEntries(s.entries()),i=new URL(t.attributes.action.value);try{o.form.onSubmit();const e=await fetch(i,{method:"POST",headers:{contentType:"application/json",dataType:"json"},body:JSON.stringify(n)}),t=await e.json();e.status>=300?(C(e),t?.errors?.sodexo_reference?o.form.error.toast("toast-sodexo"):o.form.error.toast("toast-submit-error"),o.form.onSubmitDone()):o.form.done()}catch(e){C(e.message),o.form.error.toast("toast-submit-error"),o.form.onSubmitDone()}};var D=D||window.Webflow||[];D.push((()=>{i().polyfill(),(new k).init(),document.getElementById("wf-form-Booking").onsubmit=q}))}},s={};function n(e){var i=s[e];if(void 0!==i)return i.exports;var r=s[e]={id:e,loaded:!1,exports:{}};return t[e].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=t,e=[],n.O=function(t,s,i,r){if(!s){var a=1/0;for(d=0;d<e.length;d++){s=e[d][0],i=e[d][1],r=e[d][2];for(var o=!0,c=0;c<s.length;c++)(!1&r||a>=r)&&Object.keys(n.O).every((function(e){return n.O[e](s[c])}))?s.splice(c--,1):(o=!1,r<a&&(a=r));if(o){e.splice(d--,1);var l=i();void 0!==l&&(t=l)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[s,i,r]},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={671:0};n.O.j=function(t){return 0===e[t]};var t=function(t,s){var i,r,a=s[0],o=s[1],c=s[2],l=0;if(a.some((function(t){return 0!==e[t]}))){for(i in o)n.o(o,i)&&(n.m[i]=o[i]);if(c)var d=c(n)}for(t&&t(s);l<a.length;l++)r=a[l],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(d)},s=self.webpackChunkui_booking=self.webpackChunkui_booking||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var i=n.O(void 0,[736],(function(){return n(436)}));i=n.O(i)}();
//# sourceMappingURL=Booking.bundle.js.map