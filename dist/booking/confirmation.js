/*! For license information please see confirmation.js.LICENSE.txt */
!function(){"use strict";function e(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)e[s]=i[s]}return e}var t=function t(i,s){function r(t,r,n){if("undefined"!=typeof document){"number"==typeof(n=e({},s,n)).expires&&(n.expires=new Date(Date.now()+864e5*n.expires)),n.expires&&(n.expires=n.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var a in n)n[a]&&(o+="; "+a,!0!==n[a]&&(o+="="+n[a].split(";")[0]));return document.cookie=t+"="+i.write(r,t)+o}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],s={},r=0;r<t.length;r++){var n=t[r].split("="),o=n.slice(1).join("=");try{var a=decodeURIComponent(n[0]);if(s[a]=i.read(o,a),e===a)break}catch(e){}}return e?s[e]:s}},remove:function(t,i){r(t,"",e({},i,{expires:-1}))},withAttributes:function(i){return t(this.converter,e({},this.attributes,i))},withConverter:function(i){return t(e({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(s)},converter:{value:Object.freeze(i)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),i=t;const s=(e,t)=>e.replace(new RegExp(`^${t}`),"");class r{cookie;ops;constructor(){this.cookie=window.FpCookie,this.ops=this.cookie.store}get isValid(){return Object.keys(this.ops).length>0}#e(e){return Object.entries(this.ops).filter((([t,i])=>t.startsWith(e))).reduce(((t,[i,r])=>(t[s(i,e)]=r,t)),{})}#t(e,t){return Object.entries(this.ops).filter((([i,s])=>i.startsWith(e)&&(void 0===t||s===t))).map((([t,i])=>s(t,e)))}get cleaning(){return this.ops["service-cleaning"]?this.#e("cleaning-"):{}}get extras(){return this.ops["service-cleaning"]?this.#t("extra-",!0):[]}get extra(){return this.ops["service-cleaning"]?this.#e("extra-"):{}}get ironing(){return this.ops["service-ironing"]?this.ops.ironing.replace("ironing-size-",""):""}get postalCode(){return this.ops["postal-code"]}get services(){return this.#t("service-",!0)}get service(){return this.#e("service-")}get duration(){return this.ops?.duration}get recurrence(){return this.ops?.frequency}get start(){return new Date(this.ops["start-timestamp"])}get end(){return new Date(this.ops["end-timestamp"])}get teamMember(){return{id:this.ops["team-member"],name:this.ops["team-member-name"],firstName:this.ops["team-member-first-name"]}}}const n="/booking",o="/booking/services",a="/booking/confirmation",c="__booking";class u{#i;list;constructor(e){const t=i.get(c);if(t){const e=JSON.parse(t);this.list=e.seq}else this.init({});this.current=e}init({ironing:e=!1,cleaning:t=!1}={}){let i=[n,o];e&&i.push("/booking/ironing"),t&&i.push("/booking/cleaning"),i=i.concat(["/booking/duration","/booking/availability",a]),this.list=i,this.setCookies()}setCookies(){i.set(c,JSON.stringify({seq:this.list}),{secure:!0,sameSite:"strict"})}next(){return this.list[this.#i+1]}prev(){return this.list[this.#i-1]}get total(){return this.list.length}get current(){return this.list[this.#i]}set current(e){const t=Object.values(this.list).findIndex((t=>t===e));t>=0&&(this.#i=t)}get currentIndex(){return this.#i}}class l{static id(e){return document.getElementById(e)}static q(e){return document.querySelector(e)}static qall(e){return document.querySelectorAll(e)}static toast(e){const t=l.id(e);return t.classList.add("active"),setTimeout((()=>{t.classList.remove("active")}),4e3)}static set nextButtonDisabled(e){const t=document.querySelector(".next-button-flow");t&&(t.disabled=e,e?t.classList.add("disabled"):t.classList.remove("disabled"))}static queryOptions(e,t=!1){return Array.from(document.querySelectorAll(`input[id*='${e}']${t?":checked":""}`))}static getRadio(e,t=!1){return this.q(`input[name*="${e}"]${t?":checked":""}`)}static queryRadio(e,t=!1){return Array.from(this.qall(`input[name*='${e}']${t?":checked":""}`))}static getOption(e,t=!1){return this.q(`input[id*='${e}']${t?":checked":""}`)}}var m=l;class d{sequence;constructor({formId:e="wf-form-step",sequence:t=new u}){this.sequence=t,m.id(e)&&(m.id(e).onsubmit=this.onNext.bind(this)),m.id("back-button")?.addEventListener("click",this.onBack.bind(this)),window.onpopstate=this.onBack.bind(this)}restart(){window.location.href=o}goto(e){window.location.href=e}onNext(e){e.preventDefault(),history.pushState({},null,location.href),window.location.href=this.sequence.next()}onBack(){window.location.href=this.sequence.prev()}}class h{_members;#s;constructor(){this.#s=this.#r()}async#r(){const e=new URL("https://inplace-booking.azurewebsites.net/api/collection"),t=new URLSearchParams({code:"Itrex4w/daAwDFd78PsawdASdJyo9clkm1OOhG0Z3GLEe6m484/49A==",name:"team"});e.search=t;const i=await fetch(e),s=await i.json();this._members=s}get members(){return(async()=>(await this.#s,this._members))()}async getMember(e){return(await this.members).find((t=>t.name===e))}makeMemberId(e){return`${e.first_name} ${e.last_name}`}async setMemberDetails(e,t,i){const s=await this.getMember(t);if(s){const t=s?.["profile-picture"];t?.url&&(e.querySelector(".team-avatar").src=t.url),s.french&&e.querySelector(".french").classList.remove("hidden"),s.dutch&&e.querySelector(".dutch").classList.remove("hidden"),s.english&&e.querySelector(".english").classList.remove("hidden")}const r=e.querySelector(".team-member-name");r&&(r.innerText=i.first_name);const n=e.querySelector("input");n&&(n.setAttribute("member-name",`${i.first_name} ${i.last_name}`),n.setAttribute("member-first-name",`${i.first_name}`))}}var p=class{static get selected(){return m.getRadio("ironing-size",!0)?.value?.replace(/^ironing-size-/,"")}static submitButtonText;static msgTimeout;static done(){m.id("wf-form-booking").classList.add("completed"),m.id("form-done").classList.add("active")}static onSubmit(){const e=m.id("button-submit");this.submitButtonText=e.value,e.value=e.attributes["data-wait"].value,e.disabled=!0,e.classList.add("wait"),this.msgTimeout&&(clearTimeout(this.msgTimeout),this.error.hide())}static onSubmitDone(){const e=m.id("button-submit");e.value=this.submitButtonText,e.disabled=!1,e.classList.remove("wait")}static error=class{static set title(e){m.id("error-title").innerText=e}static set detail(e){m.id("error-detail").innerText=e}static toast(e){this.msgTimeout=m.toast(e)}}},g=class{static set service(e){Object.entries(e).forEach((([e,t])=>this.displayService(e,t)))}static displayService(e,t=!0){const{classList:i}=m.id(`summary-${e}`);t?i?.add("service-active"):i?.remove("service-active")}static set recurrence(e){m.id(`summary-${e}`)?.classList.remove("hidden")}};const b="wf-form-booking";class f extends class{form;nav;ops;constructor(e,t="wf-form-step"){this.form=m.id(t),this.nav=new d({formId:t,sequence:new u(e)}),this.ops=new r,this.validateState()}init(){this.setupInputHandlers(),m.nextButtonDisabled=!0,this.toggleNext(),this.updateNav()}setupInputHandlers(){this.form.querySelectorAll("input").forEach((e=>{if("submit"===e.type)return;const t={radio:"click",number:"input"}[e.type]||"change";e.addEventListener(t,this.toggleNext.bind(this)),e.checked=!1}))}validateState(){this.ops.isValid&&this.ops.postalCode?0===this.ops.services.length&&this.nav.goto(o):this.nav.goto(n)}toggleNext(){m.nextButtonDisabled=this.isNextDisabled}get isNextDisabled(){return!1}updateNav(){m.id("step-nav").innerHTML=`Step ${this.nav.sequence.currentIndex}/${this.nav.sequence.total-1}`}}{ops;team;constructor(){super(a,b),this.ops=new r,this.team=new h}init(){super.init(),this.#n(),this.#o(),this.setupBookingSession()}setupInputHandlers(){m.id(b).onsubmit=this.onSubmit.bind(this)}async onSubmit(e){e.preventDefault();const t=e.target,i=new FormData(t),s=Object.fromEntries(i.entries()),r=this.makeBooking(s),n=new URL(t.attributes.action.value);try{p.onSubmit();const e=await fetch(n,{method:"POST",headers:{contentType:"application/json",dataType:"json"},body:JSON.stringify(r)}),t=await e.json();e.status>=300?(this.logError(e,t),t?.errors?.sodexo_reference?p.error.toast("toast-sodexo"):"UNAVAILABLE_TIME_SLOT"===t?.error?p.error.toast("toast-unavailable-slot"):"customer_unavailability"===t?.error?p.error.toast("toast-unavailable-customer"):p.error.toast("toast-submit-error"),p.onSubmitDone()):(this.handleNewBooking(t),setTimeout((()=>{p.done()}),1e3))}catch(e){this.logError(e.message),p.error.toast("toast-submit-error"),p.onSubmitDone()}}handleNewBooking(e){m.id("cal-apple").href&&=e.events.apple.url,m.id("cal-ics").href&&=e.events.apple.url,m.id("cal-google").href&&=e.events.google,m.id("cal-outlook").href&&=e.events.outlook}makeBooking(e){const t=e=>"on"===e,i={duration:e.duration,frequency:e.frequency,start_timestamp:e["start-timestamp"],end_timestamp:e["end-timestamp"],team_member_contract_id:e["team-member"],team_member_name:e["team-member-name"],customer_id:e["customer-id"],customer_address_id:e["customer-address-id"],options:{service_cleaning:t(e["service-cleaning"]),service_ironing:t(e["service-ironing"]),service_grocery:t(e["service-grocery"]),service_cooking:t(e["service-cooking"]),extra_windows:t(e["extra-windows"]),extra_cabinets:t(e["extra-cabinets"]),extra_fridge:t(e["extra-fridge"]),extra_oven:t(e["extra-oven"]),cleaning_bedrooms:e["cleaning-bedrooms"],cleaning_bathrooms:e["cleaning-bathrooms"],ironing:e.ironing?.replace("ironing-size-","")}};return s=i,Object.keys(s).forEach((e=>void 0===s[e]&&delete s[e])),s;var s}logError(e,t){console.log("Something went wrong..."),console.log(`Status: ${e.status} ${e.statusText}`),t?console.log(`Response: ${JSON.stringify(t)}`):console.log(`Response: ${e}`)}#n(){const{service:e,recurrence:t}=this.ops;g.service=e,g.recurrence=t,m.id("conf-start").innerText=this.ops.start.toLocaleString("fr",{dateStyle:"short",timeStyle:"short"})}#o(){const e={first_name:this.ops.teamMember.firstName},t=this.ops.teamMember.name,i=m.id("conf-team-member");this.team.setMemberDetails(i,t,e)}setupBookingSession(){[m.id("btn-signup"),m.id("btn-login")].forEach((e=>e?.addEventListener("click",(()=>{i.set("__inplace_booking_session",!0,{secure:!0,sameSite:"strict"})}))))}}var v=v||window.Webflow||[];v.push((()=>{(new f).init()}))}();
//# sourceMappingURL=confirmation.js.map